# memo-screen.tsx ã¨ task-screen.tsx ã®ã‚·ãƒ³ãƒ—ãƒ«å…±é€šåŒ–è¨ˆç”»

## æ¦‚è¦
ä¸¡ç”»é¢ã§å®Œå…¨ã«åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒšã—ã¦ã„ã‚‹éƒ¨åˆ†ã®ã¿ã‚’å…±é€šåŒ–ã™ã‚‹ã€ä½ãƒªã‚¹ã‚¯ãªæ”¹å–„è¨ˆç”»ã§ã™ã€‚

## å…±é€šåŒ–å¯¾è±¡ï¼ˆè¶…ä½ãƒªã‚¹ã‚¯ãƒ»è¦‹é€šã—ã®è‰¯ã„éƒ¨åˆ†ã®ã¿ï¼‰

### 1. å‰Šé™¤å®Œäº†æ™‚ã®è“‹ã‚’é–‰ã˜ã‚‹å‡¦ç†
**ç¾çŠ¶**: ä¸¡ç”»é¢ã§å…¨ãåŒã˜ã‚³ãƒ¼ãƒ‰
```typescript
useEffect(() => {
  (window as any).closeDeletingLid = () => {
    setIsRightLidOpen(false);
  };
  
  return () => {
    delete (window as any).closeDeletingLid;
  };
}, []);
```

**å…±é€šåŒ–æ¡ˆ**: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ã™ã‚‹
```typescript
// apps/web/src/hooks/use-deletion-lid.ts
export function useDeletionLid(onClose: () => void) {
  useEffect(() => {
    (window as any).closeDeletingLid = onClose;
    return () => {
      delete (window as any).closeDeletingLid;
    };
  }, [onClose]);
}
```

### 2. å‰Šé™¤ãƒ»å¾©å…ƒãƒœã‚¿ãƒ³ã®ã‚³ãƒ³ãƒ†ãƒŠéƒ¨åˆ†
**ç¾çŠ¶**: ä½ç½®ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®CSSã‚¯ãƒ©ã‚¹ãŒå®Œå…¨ã«åŒã˜

**å…±é€šåŒ–æ¡ˆ**: è–„ã„ãƒ©ãƒƒãƒ‘ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```typescript
// apps/web/components/ui/layout/button-container.tsx
interface ButtonContainerProps {
  show: boolean;
  position: 'bottom-left' | 'bottom-right';
  children: React.ReactNode;
}

export function ButtonContainer({ show, position, children }: ButtonContainerProps) {
  const positionClass = position === 'bottom-right' 
    ? 'absolute bottom-4 right-6' 
    : 'absolute bottom-4 left-6';
    
  return (
    <div className={`${positionClass} z-10 transition-opacity duration-300 ${
      show ? "opacity-100" : "opacity-0 pointer-events-none"
    }`}>
      {children}
    </div>
  );
}
```

### 3. å‰Šé™¤æ¸ˆã¿ã‚¢ã‚¤ãƒ†ãƒ ç”¨ã®å³ä¸‹å‰Šé™¤ãƒœã‚¿ãƒ³
**ç¾çŠ¶**: ä¸¡ç”»é¢ã§æ§‹é€ ãŒå®Œå…¨ã«åŒã˜
```tsx
<div className={`${DELETE_BUTTON_POSITION} z-10`}>
  <DeleteButton
    data-right-panel-trash
    onDelete={() => {
      setIsRightLidOpen(true);
      deletedItemViewerRef.current?.showDeleteConfirmation();
    }}
    isAnimating={isRightLidOpen}
    variant="danger"
  />
</div>
```

**å…±é€šåŒ–æ¡ˆ**: ãã®ã¾ã¾ä½¿ãˆã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```typescript
// apps/web/components/ui/buttons/deleted-item-delete-button.tsx
interface DeletedItemDeleteButtonProps {
  onDelete: () => void;
  isAnimating: boolean;
}

export function DeletedItemDeleteButton({ onDelete, isAnimating }: DeletedItemDeleteButtonProps) {
  return (
    <div className={`${DELETE_BUTTON_POSITION} z-10`}>
      <DeleteButton
        data-right-panel-trash
        onDelete={onDelete}
        isAnimating={isAnimating}
        variant="danger"
      />
    </div>
  );
}
```

## å®Ÿè£…æ‰‹é †ï¼ˆå®Œäº†æ¸ˆã¿ï¼‰

### âœ… ã‚¹ãƒ†ãƒƒãƒ—1: ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã®ä½œæˆ
1. `use-deletion-lid.ts` ã‚’ä½œæˆ
2. ä¸¡ç”»é¢ã§ import ã—ã¦ä½¿ç”¨

### âœ… ã‚¹ãƒ†ãƒƒãƒ—2: ButtonContainerã®ä½œæˆ
1. `button-container.tsx` ã‚’ä½œæˆ
2. å‰Šé™¤ãƒœã‚¿ãƒ³ã¨å¾©å…ƒãƒœã‚¿ãƒ³ã®è¡¨ç¤ºéƒ¨åˆ†ã‚’ç½®ãæ›ãˆ

### âœ… ã‚¹ãƒ†ãƒƒãƒ—3: é…å»¶éè¡¨ç¤ºå‡¦ç†ã®å…±é€šåŒ–ï¼ˆè¿½åŠ å®Ÿè£…ï¼‰
1. `use-delayed-button-visibility.ts` ã‚’ä½œæˆ
2. ãƒ¡ãƒ¢å´ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œã‚’ä¿®æ­£
3. ä¸¡ç”»é¢ã§é‡è¤‡ã—ã¦ã„ãŸé…å»¶éè¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ã‚’å…±é€šåŒ–

### âœ… ã‚¹ãƒ†ãƒƒãƒ—4: è–„ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å‰Šé™¤
1. `deleted-item-delete-button.tsx` ã‚’å‰Šé™¤ï¼ˆä¾¡å€¤ãŒä½ã„ãŸã‚ï¼‰
2. ç›´æ¥DeleteButtonã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´

### âœ… ã‚¹ãƒ†ãƒƒãƒ—5: å‹•ä½œç¢ºèª
1. ãƒ¡ãƒ¢ç”»é¢ã®å‰Šé™¤ãƒ»å¾©å…ƒæ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
2. ã‚¿ã‚¹ã‚¯ç”»é¢ã®å‰Šé™¤ãƒ»å¾©å…ƒæ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
3. TypeScriptã®å‹ãƒã‚§ãƒƒã‚¯é€šéç¢ºèª

## å®Ÿéš›ã®æˆæœ
- **ã‚³ãƒ¼ãƒ‰å‰Šæ¸›**: ç´„80-90è¡Œã®é‡è¤‡å‰Šé™¤
- **ä¿å®ˆæ€§**: ãƒã‚°ä¿®æ­£ãŒ1ç®‡æ‰€ã§æ¸ˆã‚€
- **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä¿®æ­£**: ãƒ¡ãƒ¢å´ã®è“‹é–‰ã˜ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å•é¡Œã‚’è§£æ±º
- **ãƒªã‚¹ã‚¯ãªã—**: ãƒ­ã‚¸ãƒƒã‚¯ã¯å¤‰æ›´ã›ãšã€è¦‹ãŸç›®ã ã‘å…±é€šåŒ–

## ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«
1. `apps/web/src/hooks/use-deletion-lid.ts` - å‰Šé™¤å®Œäº†æ™‚ã®è“‹é–‰ã˜å‡¦ç†
2. `apps/web/components/ui/layout/button-container.tsx` - ãƒœã‚¿ãƒ³é…ç½®ç”¨ã‚³ãƒ³ãƒ†ãƒŠ
3. `apps/web/src/hooks/use-delayed-button-visibility.ts` - é…å»¶éè¡¨ç¤ºå‡¦ç†

## å‰Šé™¤ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«
- `apps/web/components/ui/buttons/deleted-item-delete-button.tsx` - è–„ã™ãã‚‹ãŸã‚å‰Šé™¤

## ã‚„ã‚‰ãªã‹ã£ãŸã“ã¨ï¼ˆä»Šå›ã®æ–¹é‡ã§é™¤å¤–ï¼‰
- å…¨é¸æŠãƒ­ã‚¸ãƒƒã‚¯ã®çµ±åˆï¼ˆã‚¿ã‚¹ã‚¯ã¨ãƒ¡ãƒ¢ã§æ¡ä»¶ãŒé•ã†ãŸã‚ï¼‰
- å‰Šé™¤çŠ¶æ…‹ç®¡ç†ã®çµ±åˆï¼ˆè¤‡é›‘ã«ãªã‚‹ãŸã‚ï¼‰
- å‰Šé™¤å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®çµ±åˆï¼ˆç”»é¢ã”ã¨ã«ç•°ãªã‚‹è¦ä»¶ãŒã‚ã‚‹ãŸã‚ï¼‰

## ç¬¬2æ®µéšï¼šè¿½åŠ å…±é€šåŒ–å€™è£œã®ç™ºè¦‹

### è©³ç´°èª¿æŸ»ã®çµæœ
ä¸¡ç”»é¢ã‚’å†åº¦è©³ã—ãæ¯”è¼ƒã—ãŸçµæœã€ã¾ã å¤šãã®å…±é€šåŒ–å¯èƒ½éƒ¨åˆ†ãŒç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚

## æ–°ãŸã«ç™ºè¦‹ã•ã‚ŒãŸå…±é€šåŒ–å€™è£œ

### ğŸ”¥ **é«˜å„ªå…ˆåº¦ï¼ˆå³åº§ã«å…±é€šåŒ–å¯èƒ½ï¼‰**

#### 1. **é¸æŠè§£é™¤å‡¦ç†ï¼ˆhandleItemDeselectï¼‰** â­â­â­
**ç¾çŠ¶ã®é‡è¤‡ï¼š**
```typescript
// memoå´
const handleItemDeselect = useCallback((id: number) => {
  if (selectedMemo?.id === id || selectedDeletedMemo?.id === id) {
    onDeselectAndStayOnMemoList?.();
    setMemoScreenMode("list");
  }
}, [selectedMemo, selectedDeletedMemo, onDeselectAndStayOnMemoList, setMemoScreenMode]);

// taskå´  
const handleItemDeselect = useCallback((id: number) => {
  if (selectedTask?.id === id || selectedDeletedTask?.id === id) {
    onClearSelection?.();
    setTaskScreenMode("list");
  }
}, [selectedTask, selectedDeletedTask, onClearSelection, setTaskScreenMode]);
```

**å…±é€šåŒ–æ¡ˆï¼š**
```typescript
// apps/web/src/hooks/use-item-deselect.ts
export function useItemDeselect(
  selectedItem: any,
  selectedDeletedItem: any,
  onClearSelection: () => void,
  setScreenMode: (mode: string) => void
) {
  return useCallback((id: number) => {
    if (selectedItem?.id === id || selectedDeletedItem?.id === id) {
      onClearSelection();
      setScreenMode("list");
    }
  }, [selectedItem, selectedDeletedItem, onClearSelection, setScreenMode]);
}
```

#### 2. **å…¨é¸æŠæ©Ÿèƒ½ï¼ˆhandleSelectAllï¼‰** â­â­â­
**ç¾çŠ¶ã®é‡è¤‡ï¼š** ç´„30è¡Œã®é¡ä¼¼ã‚³ãƒ¼ãƒ‰

**å…±é€šåŒ–æ¡ˆï¼š**
```typescript
// apps/web/src/hooks/use-select-all.ts
export function useSelectAll<T extends {id: number}>(
  activeTab: string,
  items: T[] | null,
  deletedItems: T[] | null,
  checkedItems: Set<number>,
  checkedDeletedItems: Set<number>,
  setCheckedItems: (items: Set<number>) => void,
  setCheckedDeletedItems: (items: Set<number>) => void,
  filterFn?: (item: T, activeTab: string) => boolean
) {
  // isAllSelectedè¨ˆç®— + handleSelectAllå‡¦ç†
}
```

#### 3. **ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆå‡¦ç†** â­â­â­
**ç¾çŠ¶ã®é‡è¤‡ï¼š** ä¸¡ç”»é¢ã§ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ™‚ã®é¸æŠã‚¯ãƒªã‚¢å‡¦ç†ãŒåŒã˜ãƒ‘ã‚¿ãƒ¼ãƒ³

**å…±é€šåŒ–æ¡ˆï¼š**
```typescript
// apps/web/src/hooks/use-tab-change.ts
export function useTabChange(
  setActiveTab: (tab: string) => void,
  setScreenMode: (mode: string) => void,
  onClearSelection: () => void,
  // ... é¸æŠçŠ¶æ…‹ç®¡ç†
) {
  // çµ±ä¸€ã•ã‚ŒãŸã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆå‡¦ç†
}
```

### ğŸŸ¡ **ä¸­å„ªå…ˆåº¦ï¼ˆè¨ˆç”»çš„ã«å…±é€šåŒ–ï¼‰**

#### 4. **å‰Šé™¤å¾Œã®æ¬¡é¸æŠå‡¦ç†** â­â­
**ç¾çŠ¶ï¼š** `selectNextDeletedMemo` ã¨ `selectNextDeletedTask` ã§é¡ä¼¼ãƒ­ã‚¸ãƒƒã‚¯

#### 5. **å¾©å…ƒå‡¦ç†** â­â­
**ç¾çŠ¶ï¼š** `handleRestoreAndSelectNext` ç³»ã®å‡¦ç†ã§é¡ä¼¼ãƒ‘ã‚¿ãƒ¼ãƒ³

#### 6. **ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼è¡¨ç¤ºåˆ¶å¾¡** â­â­
**ç¾çŠ¶ï¼š** å³ãƒ‘ãƒãƒ«å†…ã§ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯

## å‰Šæ¸›åŠ¹æœã®è¦‹ç©ã‚‚ã‚Š

### ãƒ•ã‚§ãƒ¼ã‚º2ã§ã®äºˆæƒ³å‰Šæ¸›åŠ¹æœ
- **é«˜å„ªå…ˆåº¦3é …ç›®**: ç´„60-80è¡Œã®é‡è¤‡å‰Šé™¤
- **ä¸­å„ªå…ˆåº¦3é …ç›®**: ç´„80-120è¡Œã®é‡è¤‡å‰Šé™¤
- **åˆè¨ˆ**: ç´„140-200è¡Œã®è¿½åŠ å‰Šæ¸›

### ç´¯è¨ˆå‰Šæ¸›åŠ¹æœ
- **ãƒ•ã‚§ãƒ¼ã‚º1**: 80-90è¡Œå‰Šæ¸›æ¸ˆã¿
- **ãƒ•ã‚§ãƒ¼ã‚º2**: 140-200è¡Œå‰Šæ¸›äºˆå®š
- **ç´¯è¨ˆ**: 220-290è¡Œã®é‡è¤‡å‰Šé™¤

## å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### å³åº§ã«å®Ÿè£…å¯èƒ½ï¼ˆä½ãƒªã‚¹ã‚¯ï¼‰
1. `useItemDeselect` - 15åˆ†
2. `useSelectAll` - 30åˆ†
3. `useTabChange` - 20åˆ†

### è¨ˆç”»çš„ã«å®Ÿè£…ï¼ˆä¸­ãƒªã‚¹ã‚¯ï¼‰
4. `useNextItemSelection` - 45åˆ†
5. `useRestoreAndSelectNext` - 30åˆ†
6. `useEditorControl` - 60åˆ†

## æ–¹é‡
ç¾åœ¨ã®æˆæœï¼ˆ80-90è¡Œå‰Šæ¸›ï¼‰ã§ä¸€æ—¦åŒºåˆ‡ã‚Šã¨ã™ã‚‹ã‹ã€ã•ã‚‰ã«é€²ã‚ã¦å¤§å¹…ãªå…±é€šåŒ–ï¼ˆ220-290è¡Œå‰Šæ¸›ï¼‰ã‚’ç›®æŒ‡ã™ã‹ã¯è¦æ¤œè¨ã€‚ãŸã ã—ã€é«˜å„ªå…ˆåº¦ã®3é …ç›®ã¯å³åº§ã«å®Ÿè£…å¯èƒ½ã§å¤§ããªåŠ¹æœãŒæœŸå¾…ã§ãã‚‹ã€‚