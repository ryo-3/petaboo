# リファクタリングチェックルール

コミット前に以下の項目をチェックしてください。

## 🔴 エラー（コミット中断を推奨）

### 1. 危険な型キャスト

- `as unknown as` の使用
- **理由**: 型安全性を破壊する
- **推奨**: Zodスキーマでバリデーション

### 2. title属性の直接使用

- HTMLタグの `title=` 属性
- **理由**: UIコンポーネントの一貫性
- **推奨**: Tooltipコンポーネントを使用

### 3. 共通型の未使用

- `OriginalId` 型を使わず `string` 直書き
- **理由**: 型安全性と一貫性
- **推奨**: `apps/web/src/types/common.ts` の共通型を使用

## 🟡 警告（確認推奨、コミットは可）

### 4. any型の使用

- `: any` 型の使用
- **理由**: 型安全性の低下
- **推奨**: 具体的な型定義

### 5. 型エラー抑制

- `@ts-ignore` / `@ts-expect-error` コメント
- **理由**: 根本的な問題を隠蔽
- **推奨**: 型エラーの根本修正

### 6. コード重複

- 同じ関数名が複数ファイルに存在
- 同じロジックの繰り返し
- **理由**: 保守性の低下
- **推奨**: 共通化（2回以上使うなら即共通化）

### 7. console.log の残留

- `console.log` / `console.warn` / `console.error`
- **理由**: デバッグコードの残留
- **推奨**: 本番環境では削除

### 8. 長い関数

- 100行以上の関数
- **理由**: 可読性・保守性の低下
- **推奨**: 小さな関数に分割

## 📋 チェック方法

1. 変更ファイル（git diff --cached）を確認
2. 上記ルールに違反していないかチェック
3. エラーがあればファイル名と行番号を報告
4. 警告は確認を促すが、コミットは許可

## 🎯 レポート形式

```
🔍 リファクタリングチェック結果

🔴 エラー（即修正推奨）
📍 apps/web/components/ui/button.tsx:42
  - `as unknown as` 使用検出
  💡 Zodスキーマでバリデーション推奨

🟡 警告
📍 apps/web/src/hooks/use-memo-list.ts:15
📍 apps/web/src/hooks/use-task-list.ts:18
  - 類似パターン検出（fetchList関数）
  💡 共通化候補: packages/shared/src/hooks/use-fetch-list.ts

✅ 問題なし
- その他のファイル
```

## 💡 使用方法

コミット前に以下を実行：

```
リファクタリングチェックして
```

または

```
.claude/refactor-rules.md に従ってチェックして
```
