# ğŸ“± ãƒ¢ãƒã‚¤ãƒ«ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯å®Œå…¨ã‚¬ã‚¤ãƒ‰

## ğŸ¯ 1. ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆã®æ ¸å¿ƒãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæœ€é‡è¦ï¼‰

### ã©ã“ã‚’è¦‹ã‚Œã°ã„ã„ï¼Ÿ

**[sidebar.tsx:170-174](apps/web/components/layout/sidebar.tsx#L170-L174)**

```typescript
// ãƒ¢ãƒã‚¤ãƒ«ã§ãƒ¡ãƒ¢ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã¯å°‚ç”¨ãƒ•ãƒƒã‚¿ãƒ¼ã‚’è¡¨ç¤º
// æ–°è¦ä½œæˆæ™‚ï¼ˆselectedMemoId === null ã‹ã¤ isCreatingMemo === trueï¼‰ã‚‚å«ã‚€
const isShowingMemoEditor = selectedMemoId !== undefined || isCreatingMemo;

// ãƒ¢ãƒã‚¤ãƒ«ã§ã‚¿ã‚¹ã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã¯å°‚ç”¨ãƒ•ãƒƒã‚¿ãƒ¼ã‚’è¡¨ç¤º
// æ–°è¦ä½œæˆæ™‚ã‚‚å«ã‚€
const isShowingTaskEditor = selectedTaskId !== undefined || isCreatingTask;
```

**ğŸ‘‰ ã“ã®2ã¤ã®å¤‰æ•°ãŒ `true` ã«ãªã‚‹ã¨ãƒ¢ãƒã‚¤ãƒ«ãƒ•ãƒƒã‚¿ãƒ¼ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ï¼**

---

## ğŸ”„ 2. ãƒ•ãƒƒã‚¿ãƒ¼è¡¨ç¤ºã®å„ªå…ˆé †ä½

**[sidebar.tsx:177-262](apps/web/components/layout/sidebar.tsx#L177-L262)**

```
å„ªå…ˆé †ä½: ã‚¿ã‚¹ã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãƒ•ãƒƒã‚¿ãƒ¼ > ãƒ¡ãƒ¢ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãƒ•ãƒƒã‚¿ãƒ¼ > é€šå¸¸ãƒ•ãƒƒã‚¿ãƒ¼ (null)
```

```typescript
const mobileFooter = isShowingTaskEditor ? (
  // ã‚¿ã‚¹ã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”¨ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆItemEditorFooter type="task"ï¼‰
  <ItemEditorFooter type="task" ... />
) : isShowingMemoEditor ? (
  // ãƒ¡ãƒ¢ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”¨ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆItemEditorFooter type="memo"ï¼‰
  <ItemEditorFooter type="memo" ... />
) : null;
  // é€šå¸¸æ™‚ã¯ãƒ•ãƒƒã‚¿ãƒ¼ãªã—ï¼ˆé€šå¸¸ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼‰
```

---

## ğŸ“ 3. é‡è¦ãªå¤‰æ•°ã®è¿½è·¡å ´æ‰€

### å€‹äººãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ«ãƒ¼ãƒˆãƒšãƒ¼ã‚¸ï¼‰

#### `isCreatingMemo` ã¨ `isCreatingTask` ã®ç”Ÿæˆ

**[main-client-mobile.tsx:59-60](apps/web/components/client/main-client-mobile.tsx#L59-L60)**

```typescript
const isCreatingMemo = screenMode === "create" && currentMode === "memo";
const isCreatingTask = screenMode === "create" && currentMode === "task";
```

ğŸ‘‰ `screenMode` ãŒ `"create"` ã‹ã¤ `currentMode` ãŒ `"memo"` or `"task"` ã§åˆ¤å®š

#### `selectedMemoId` ã¨ `selectedTaskId`

- è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆ`page.tsx` ãªã©ï¼‰ã‹ã‚‰ Props ã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹
- ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯ã‚’é¸æŠã™ã‚‹ã¨ `undefined` ä»¥å¤–ã®å€¤ã«ãªã‚‹

---

### ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ï¼ˆ`/team/[customUrl]` ãƒšãƒ¼ã‚¸ï¼‰

#### `isCreatingMemo` ã¨ `isCreatingTask` ã®ç®¡ç†

**[team-detail-context.tsx:46-47](apps/web/src/contexts/team-detail-context.tsx#L46-L47)**

```typescript
const [isCreatingMemo, setIsCreatingMemo] = useState(false);
const [isCreatingTask, setIsCreatingTask] = useState(false);
```

ğŸ‘‰ TeamDetailContext ã§çŠ¶æ…‹ç®¡ç†ï¼ˆuseStateï¼‰

#### çŠ¶æ…‹ã®æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚°ä¾‹

**[team-detail.tsx:430](apps/web/components/features/team/team-detail.tsx#L430)**

```typescript
const handleTeamNewMemo = (_event: CustomEvent) => {
  setIsCreatingMemo(true); // æ–°è¦ãƒ¡ãƒ¢ä½œæˆæ™‚ã« true ã«è¨­å®š
  handleTabChange("memos");
};
```

**[memo-screen.tsx:346](apps/web/components/screens/memo-screen.tsx#L346)**

```typescript
useEffect(() => {
  if (teamDetailContext) {
    teamDetailContext.setIsCreatingMemo(memoScreenMode === "create");
  }
}, [memoScreenMode, teamDetailContext]);
```

---

### Sidebar ã§ã® Props ã¨ Context ã®çµ±åˆ

**[sidebar.tsx:89-100](apps/web/components/layout/sidebar.tsx#L89-L100)**

```typescript
let isCreatingMemo = isCreatingMemoProp ?? false;
let isCreatingTask = isCreatingTaskProp ?? false;

// ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã¯TeamDetailContextã‹ã‚‰ã‚‚å–å¾—
if (isTeamMode) {
  try {
    const teamDetail = useTeamDetail();
    isCreatingMemo = teamDetail.isCreatingMemo;
    isCreatingTask = teamDetail.isCreatingTask ?? false;
  } catch {
    // ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰å¤–ã§ã¯ç„¡è¦–
  }
}
```

ğŸ‘‰ ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§ã¯ Context ã‚’å„ªå…ˆã€å€‹äººãƒ¢ãƒ¼ãƒ‰ã§ã¯ Props ã‚’ä½¿ç”¨

---

## ğŸª 4. ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ å…¨ä½“å›³

### ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼

```
ã€ç™ºç«å…ƒã€‘
Sidebar (ItemEditorFooter ã® onBack)
  â†“
ã€ç™ºç«ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã€‘
  å€‹äººãƒ¢ãƒ¼ãƒ‰:
    - memo-editor-mobile-back-requested    (ãƒ¡ãƒ¢ä¸€è¦§ã¸æˆ»ã‚‹)
    - task-editor-mobile-back-requested    (ã‚¿ã‚¹ã‚¯ä¸€è¦§ã¸æˆ»ã‚‹)

  ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰:
    - team-back-to-memo-list              (ãƒ¡ãƒ¢ä¸€è¦§ã¸æˆ»ã‚‹)
    - team-back-to-task-list              (ã‚¿ã‚¹ã‚¯ä¸€è¦§ã¸æˆ»ã‚‹)
  â†“
ã€å—ä¿¡ãƒ»å‡¦ç†ã€‘
  å€‹äººãƒ¢ãƒ¼ãƒ‰:
    - memo-editor.tsx (ãƒ¡ãƒ¢ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼æœ¬ä½“)
    - task-screen.tsx (ã‚¿ã‚¹ã‚¯ç”»é¢)
    - create-screen.tsx (æ–°è¦ä½œæˆç”»é¢)
    - memo-screen.tsx (ãƒ¡ãƒ¢ä¸€è¦§ç”»é¢)

  ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰:
    - memo-screen.tsx (team-back-to-memo-list ã‚’å—ä¿¡)
    - task-screen.tsx (team-back-to-task-list ã‚’å—ä¿¡)
    - team-detail.tsx (ä¸¡ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ã—ã¦çŠ¶æ…‹æ›´æ–°)
```

### ã‚¤ãƒ™ãƒ³ãƒˆåã®ä½¿ã„åˆ†ã‘

**ãƒ¡ãƒ¢ã®æˆ»ã‚‹ãƒœã‚¿ãƒ³ - [sidebar.tsx:228-234](apps/web/components/layout/sidebar.tsx#L228-L234)**

```typescript
const backEventName = isTeamMode
  ? "team-back-to-memo-list"
  : "memo-editor-mobile-back-requested";
window.dispatchEvent(new CustomEvent(backEventName));
```

**ã‚¿ã‚¹ã‚¯ã®æˆ»ã‚‹ãƒœã‚¿ãƒ³ - [sidebar.tsx:182-185](apps/web/components/layout/sidebar.tsx#L182-L185)**

```typescript
const backEventName = isTeamMode
  ? "team-back-to-task-list"
  : "task-editor-mobile-back-requested";
window.dispatchEvent(new CustomEvent(backEventName));
```

ğŸ‘‰ ãƒãƒ¼ãƒ /å€‹äººã§ã‚¤ãƒ™ãƒ³ãƒˆåã‚’åˆ‡ã‚Šæ›¿ãˆ

---

## ğŸ“‚ 5. å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã¨é‡è¦ãªè¡Œç•ªå·

ã™ã¹ã¦ `apps/web/components/` é…ä¸‹

| ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                             | å½¹å‰²                     | é‡è¦ãªè¡Œç•ªå·             | èª¬æ˜                                              |
| ---------------------------------------- | ------------------------ | ------------------------ | ------------------------------------------------- |
| **layout/sidebar.tsx**                   | **ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆæœ¬ä½“** | **89-100, 170-262, 272** | Props/Contextçµ±åˆã€åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã€ãƒ•ãƒƒã‚¿ãƒ¼è¡¨ç¤ºåˆ¶å¾¡ |
| **mobile/item-editor-footer.tsx**        | ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯çµ±åˆãƒ•ãƒƒã‚¿ãƒ¼  | 36-92                    | type prop ã§ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯ã‚’åˆ‡ã‚Šæ›¿ãˆ                 |
| **mobile/mobile-editor-footer.tsx**      | æ±ç”¨ãƒ•ãƒƒã‚¿ãƒ¼ãƒ™ãƒ¼ã‚¹       | 36-77                    | æˆ»ã‚‹ãƒœã‚¿ãƒ³ + å‹•çš„ãƒœã‚¿ãƒ³é…åˆ—                       |
| **client/main-client-mobile.tsx**        | å€‹äººãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹ç”Ÿæˆ       | 59-60, 91-92             | screenMode ã‹ã‚‰ isCreating åˆ¤å®š                   |
| **client/main-client-desktop.tsx**       | ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—çŠ¶æ…‹ç”Ÿæˆ     | 62-63, 100-101           | åŒæ§˜ã«ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã§ã‚‚ä½¿ç”¨                        |
| **src/contexts/team-detail-context.tsx** | ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹ç®¡ç†     | 46-47, 65-67             | Context ã§çŠ¶æ…‹ã‚’ä¸€å…ƒç®¡ç†                          |
| **features/team/team-detail.tsx**        | ãƒãƒ¼ãƒ ãƒšãƒ¼ã‚¸æœ¬ä½“         | 62-63, 430, 548          | Context ã® setter ã‚’å‘¼ã³å‡ºã—                      |
| **features/memo/memo-editor.tsx**        | ãƒ¡ãƒ¢ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼æœ¬ä½“       | 982-991                  | ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²ãƒ»è§£é™¤                        |
| **screens/task-screen.tsx**              | ã‚¿ã‚¹ã‚¯ç”»é¢               | (ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ç®‡æ‰€)       | ã‚¿ã‚¹ã‚¯ç”¨ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†                              |
| **screens/create-screen.tsx**            | æ–°è¦ä½œæˆç”»é¢             | 102-119                  | ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯æ–°è¦ä½œæˆæ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ                   |
| **screens/memo-screen.tsx**              | ãƒ¡ãƒ¢ä¸€è¦§ç”»é¢             | 346, 668-678             | Context æ›´æ–° + ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡                       |

---

## ğŸ” 6. ãƒ‡ãƒãƒƒã‚°æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ

### ãƒ•ãƒƒã‚¿ãƒ¼ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‰ãªã„å ´åˆ

1. **åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã‚’ç¢ºèª**
   - `sidebar.tsx:170-174` ã® `isShowingMemoEditor` / `isShowingTaskEditor` ã®å€¤ã‚’ãƒ­ã‚°å‡ºåŠ›
   - `selectedMemoId !== undefined` ã¾ãŸã¯ `isCreatingMemo` ãŒ `true` ã«ãªã£ã¦ã„ã‚‹ã‹ï¼Ÿ

2. **Props/Context ã®å€¤ã‚’ç¢ºèª**
   - å€‹äººãƒ¢ãƒ¼ãƒ‰: `main-client-mobile.tsx:59-60` ã® `screenMode` ã¨ `currentMode` ã‚’ãƒ­ã‚°å‡ºåŠ›
   - ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰: `team-detail-context.tsx:46-47` ã®çŠ¶æ…‹ã‚’ãƒ­ã‚°å‡ºåŠ›

3. **Sidebar ã¸ã®ä¼æ’­ã‚’ç¢ºèª**
   - `sidebar.tsx:89-100` ã§ Props/Context ãŒæ­£ã—ãçµ±åˆã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
   - `isTeamMode` ã®åˆ¤å®šãŒæ­£ã—ã„ã‹ï¼Ÿ

4. **è¡¨ç¤ºæ¡ä»¶ã‚’ç¢ºèª**
   - `sidebar.tsx:272` ã® `className` ã« `hidden md:flex` ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
   - ãƒ¢ãƒã‚¤ãƒ«æ™‚ã«é€šå¸¸ãƒ•ãƒƒã‚¿ãƒ¼ãŒéè¡¨ç¤ºã«ãªã£ã¦ã„ã‚‹ã‹ï¼Ÿ

### ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ãªã„å ´åˆ

1. **ã‚¤ãƒ™ãƒ³ãƒˆåã‚’ç¢ºèª**
   - ãƒãƒ¼ãƒ /å€‹äººã§æ­£ã—ã„ã‚¤ãƒ™ãƒ³ãƒˆåãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
   - `sidebar.tsx:182-185, 188-191` ã®ã‚¤ãƒ™ãƒ³ãƒˆåã‚’ç¢ºèª

2. **ãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²ã‚’ç¢ºèª**
   - è©²å½“ç”»é¢ï¼ˆmemo-editor, task-screen ãªã©ï¼‰ã§ãƒªã‚¹ãƒŠãƒ¼ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ
   - `useEffect` ã®ä¾å­˜é…åˆ—ãŒæ­£ã—ã„ã‹ï¼Ÿ

3. **ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ã‚’ç¢ºèª**
   - `console.log` ã§ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡ã‚’ç¢ºèª
   - `sidebar.tsx:228-230` ã«æ—¢ã«ãƒ­ã‚°ãŒå…¥ã£ã¦ã„ã‚‹ï¼ˆãƒ¡ãƒ¢ã®å ´åˆï¼‰

---

## ğŸ’¡ 7. ã‚ˆãã‚ã‚‹å•é¡Œãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: æ–°è¦ä½œæˆæ™‚ã«ãƒ•ãƒƒã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„

**åŸå› :** `isCreatingMemo` / `isCreatingTask` ãŒ `false` ã®ã¾ã¾

**ç¢ºèªç®‡æ‰€:**

- å€‹äººãƒ¢ãƒ¼ãƒ‰: `screenMode` ãŒ `"create"` ã«ãªã£ã¦ã„ã‚‹ã‹ï¼Ÿ
- ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰: `setIsCreatingMemo(true)` ãŒå‘¼ã°ã‚Œã¦ã„ã‚‹ã‹ï¼Ÿ

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: é€šå¸¸ãƒ•ãƒƒã‚¿ãƒ¼ã¨ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ãƒ•ãƒƒã‚¿ãƒ¼ãŒä¸¡æ–¹è¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› :** `sidebar.tsx:272` ã®æ¡ä»¶åˆ†å²ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ãªã„

**ç¢ºèªç®‡æ‰€:**

```typescript
className={`... ${isShowingMemoEditor ? "hidden md:flex" : "flex"}`}
```

ğŸ‘‰ `isShowingMemoEditor` ãŒ `true` ã®æ™‚ã«ãƒ¢ãƒã‚¤ãƒ«ã§ `hidden` ã«ãªã‚‹ã‹ï¼Ÿ

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: ãƒãƒ¼ãƒ /å€‹äººã§ãƒ•ãƒƒã‚¿ãƒ¼ã®å‹•ä½œãŒç•°ãªã‚‹

**åŸå› :** ã‚¤ãƒ™ãƒ³ãƒˆåã®ä¸ä¸€è‡´ã€ã¾ãŸã¯ Context ã®ä½¿ã„åˆ†ã‘ãƒŸã‚¹

**ç¢ºèªç®‡æ‰€:**

- `sidebar.tsx:89-100` ã® `isTeamMode` åˆ¤å®š
- `sidebar.tsx:182-185` ã®ã‚¤ãƒ™ãƒ³ãƒˆååˆ‡ã‚Šæ›¿ãˆ
- ãƒªã‚¹ãƒŠãƒ¼å´ã®ã‚¤ãƒ™ãƒ³ãƒˆåï¼ˆ`team-` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã®æœ‰ç„¡ï¼‰

---

## â• 8. ãƒ¢ãƒã‚¤ãƒ«å³ä¸‹ã®æ–°è¦è¿½åŠ ãƒœã‚¿ãƒ³ï¼ˆFABï¼‰

### é…ç½®å ´æ‰€ã¨å®Ÿè£…

#### ãƒ¡ãƒ¢ä¸€è¦§ç”»é¢

**[memo-screen.tsx:1031-1048](apps/web/components/screens/memo-screen.tsx#L1031-L1048)**

```typescript
<button
  onClick={() => {
    // æ–°è¦ä½œæˆå‡¦ç†
    handleCreateNewItem(
      () => onEditMemo(),
      filteredSortedMemos,
    );
  }}
  className="md:hidden fixed bottom-16 right-2 size-9 bg-Green hover:bg-Green/90 text-white rounded-full shadow-lg flex items-center justify-center z-20 transition-all"
>
  <svg className="size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" strokeWidth={2.5}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M12 4v16m8-8H4" />
  </svg>
</button>
```

#### ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢

**[task-screen.tsx:978-995](apps/web/components/screens/task-screen.tsx#L978-L995)**

```typescript
<button
  onClick={() => {
    // æ–°è¦ä½œæˆå‡¦ç†
    handleCreateNewItem(
      () => onEditTask(),
      filteredSortedTasks,
    );
  }}
  className="md:hidden fixed bottom-16 right-2 size-9 bg-DeepBlue hover:bg-DeepBlue/90 text-white rounded-full shadow-lg flex items-center justify-center z-20 transition-all"
>
  <svg className="size-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" strokeWidth={2.5}>
    <path strokeLinecap="round" strokeLinejoin="round" d="M12 4v16m8-8H4" />
  </svg>
</button>
```

### ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜

**é…ç½®:**

- `fixed bottom-16 right-2`: ä¸‹éƒ¨ãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆh-14ï¼‰ã®ä¸Šã€å³ç«¯ã‹ã‚‰8px
- `size-9`: 36px Ã— 36pxï¼ˆæ­£å††ï¼‰
- `z-20`: ãƒ•ãƒƒã‚¿ãƒ¼ã‚ˆã‚Šå‰é¢ã«è¡¨ç¤º

**ã‚«ãƒ©ãƒ¼:**

- ãƒ¡ãƒ¢: `bg-Green` (ç·‘è‰²)
- ã‚¿ã‚¹ã‚¯: `bg-DeepBlue` (é’è‰²)

**è¡¨ç¤ºæ¡ä»¶:**

- `md:hidden`: ãƒ¢ãƒã‚¤ãƒ«ã®ã¿è¡¨ç¤ºï¼ˆPC ã§ã¯éè¡¨ç¤ºï¼‰
- ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯ä¸€è¦§ç”»é¢ã§ã®ã¿è¡¨ç¤º
- ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”»é¢ã§ã¯éè¡¨ç¤ºï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹ï¼‰

### å‹•ä½œ

1. **ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†:**
   - `handleCreateNewItem()` ã‚’å‘¼ã³å‡ºã—
   - `onEditMemo()` ã¾ãŸã¯ `onEditTask()` ã§æ–°è¦ä½œæˆç”»é¢ã«é·ç§»
   - `isCreatingMemo` ã¾ãŸã¯ `isCreatingTask` ãŒ `true` ã«ãªã‚‹

2. **ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆã¨ã®é€£æº:**
   ```
   FABãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
     â†“
   onEditMemo() / onEditTask() å®Ÿè¡Œ
     â†“
   isCreatingMemo / isCreatingTask ãŒ true ã«
     â†“
   sidebar.tsx:170-174 ã®åˆ¤å®šã§ isShowingMemoEditor / isShowingTaskEditor ãŒ true ã«
     â†“
   ãƒ¢ãƒã‚¤ãƒ«ãƒ•ãƒƒã‚¿ãƒ¼ãŒã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”¨ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹
     â†“
   FABãƒœã‚¿ãƒ³ã¯éè¡¨ç¤ºã«ãªã‚‹ï¼ˆã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç”»é¢ã®ãŸã‚ï¼‰
   ```

### é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

**FABé…ç½®ã®å‚è€ƒ:**
**[MOBILE-DESIGN-BASE.md:174-176](MOBILE-DESIGN-BASE.md#L174-L176)**

```tsx
<button className="md:hidden fixed bottom-16 right-2 size-9 bg-Green hover:bg-Green/90 text-white rounded-full shadow-lg flex items-center justify-center z-20">
  <PlusIcon className="size-5" />
</button>
```

**CreateButton ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ:**
**[ui/buttons/create-button.tsx](apps/web/components/ui/buttons/create-button.tsx)**

- æ±ç”¨çš„ãªæ–°è¦ä½œæˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- ã‚«ãƒ©ãƒ¼ãƒ»ã‚µã‚¤ã‚ºãƒ»ä½ç½®ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½
- ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¡¨ç¤ºå¯¾å¿œ

---

## ğŸ”§ 9. ãƒãƒ¼ãƒ å´ã®æ–°è¦ä½œæˆãƒ»æˆ»ã‚‹å‡¦ç†ï¼ˆé‡è¦ï¼‰

### ãƒãƒ¼ãƒ å´ã®æ–°è¦ä½œæˆã‹ã‚‰ä¸€è¦§ã«æˆ»ã‚‹ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒFABãƒœã‚¿ãƒ³ï¼ˆå³ä¸‹ã®+ãƒœã‚¿ãƒ³ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. MobileFabButton ãŒ team-memo-create / team-task-create ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
   â†“
3. MemoScreen / TaskScreen ãŒã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡
   â†“
4. handleCreateNew() ãŒå®Ÿè¡Œã•ã‚Œã€memoScreenMode / taskScreenMode ãŒ "create" ã«
   â†“
5. MemoScreen ã® useEffect ã§ teamDetailContext.setIsCreatingMemo(true) ã‚’å®Ÿè¡Œ
   â†“
6. Sidebar ã® isCreatingMemo ãŒ true ã«ãªã‚Šã€ItemEditorFooter ãŒè¡¨ç¤ºã•ã‚Œã‚‹
   â†“
ã€æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‘
   â†“
7. Sidebar ãŒ team-back-to-memo-list / team-back-to-task-list ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
   â†“
8. MemoScreen / TaskScreen ãŒã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ï¼ˆhandleBackRequestï¼‰
   â†“
9. setMemoScreenMode("list") ã§æ–°è¦ä½œæˆãƒ¢ãƒ¼ãƒ‰ã‚’è§£é™¤ â† ã“ã‚ŒãŒé‡è¦ï¼
   â†“
10. onDeselectAndStayOnMemoList() ã‚’å‘¼ã³å‡ºã—
   â†“
11. team-detail.tsx ã® handleBackToMemoList ãŒå®Ÿè¡Œ
   â†“
12. setIsCreatingMemo(false) ã§çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
   â†“
13. Sidebar ã® isCreatingMemo ãŒ false ã«ãªã‚Šã€é€šå¸¸ãƒ•ãƒƒã‚¿ãƒ¼ã«æˆ»ã‚‹
   â†“
14. ãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹
```

### é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆ

**[memo-screen.tsx:653-688](apps/web/components/screens/memo-screen.tsx#L653-L688)**

```typescript
const handleBackRequest = () => {
  // æ–°è¦ä½œæˆãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰æŠœã‘ã‚‹ï¼ˆã“ã‚ŒãŒãªã„ã¨ä¸€è¦§ã«æˆ»ã‚Œãªã„ï¼ï¼‰
  if (screenMode === "create") {
    setMemoScreenMode("list");
  }

  if (onDeselectAndStayOnMemoList) {
    onDeselectAndStayOnMemoList();
  }
};

// ãƒãƒ¼ãƒ /å€‹äººã§ç•°ãªã‚‹ã‚¤ãƒ™ãƒ³ãƒˆåã‚’ãƒªãƒƒã‚¹ãƒ³
const backEventName = teamMode
  ? "team-back-to-memo-list"
  : "memo-editor-mobile-back-requested";
window.addEventListener(backEventName, handleBackRequest);
```

**[task-screen.tsx:389-414](apps/web/components/screens/task-screen.tsx#L389-L414)**

```typescript
const handleBackRequest = () => {
  // ã‚¿ã‚¹ã‚¯ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚’é–‰ã˜ã¦ãƒªã‚¹ãƒˆã«æˆ»ã‚‹
  onSelectTaskRef.current(null);
};

// ãƒãƒ¼ãƒ /å€‹äººã§ç•°ãªã‚‹ã‚¤ãƒ™ãƒ³ãƒˆåã‚’ãƒªãƒƒã‚¹ãƒ³
const backEventName = teamMode
  ? "team-back-to-task-list"
  : "task-editor-mobile-back-requested";
window.addEventListener(backEventName, handleBackRequest);
```

**[team-detail.tsx:450-462, 980-996](apps/web/components/features/team/team-detail.tsx)**

```typescript
// ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼
const handleBackToMemoList = (_event: CustomEvent) => {
  setSelectedMemo(null);
  setSelectedDeletedMemo(null);
  setIsCreatingMemo(false); // â† Context ã®çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
  // URLæ›´æ–° + router.replace
};

// MemoScreen ã«æ¸¡ã™ props
onDeselectAndStayOnMemoList={() => {
  // URLæ›´æ–° + çŠ¶æ…‹ã‚¯ãƒªã‚¢
  setSelectedMemo(null);
  setSelectedDeletedMemo(null);
  setIsCreatingMemo(false); // â† ã“ã‚Œã‚‚å¿…è¦ï¼
}}
```

### ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºç­–

#### ã‚¨ãƒ©ãƒ¼1: æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚‚ä¸€è¦§ã«æˆ»ã‚‰ãªã„

**åŸå› :** `MemoScreen` / `TaskScreen` ã§ `setScreenMode("list")` ã‚’å‘¼ã‚“ã§ã„ãªã„

**è§£æ±º:** `handleBackRequest` å†…ã§ `screenMode === "create"` ã®æ™‚ã« `setScreenMode("list")` ã‚’å‘¼ã¶

#### ã‚¨ãƒ©ãƒ¼2: ã‚¤ãƒ™ãƒ³ãƒˆãŒå—ä¿¡ã•ã‚Œãªã„

**åŸå› :** ã‚¤ãƒ™ãƒ³ãƒˆåã®ä¸ä¸€è‡´ï¼ˆ`team-task-editor-mobile-back-requested` vs `team-back-to-task-list`ï¼‰

**è§£æ±º:** Sidebar ã¨ãƒªã‚¹ãƒŠãƒ¼å´ã®ã‚¤ãƒ™ãƒ³ãƒˆåã‚’çµ±ä¸€ã™ã‚‹

#### ã‚¨ãƒ©ãƒ¼3: ç„¡é™ãƒ«ãƒ¼ãƒ—ãŒç™ºç”Ÿã™ã‚‹

**åŸå› :** `team-detail.tsx` ãŒåŒã˜ã‚¤ãƒ™ãƒ³ãƒˆã‚’å†ç™ºç«ã—ã¦ã„ã‚‹

**è§£æ±º:** `team-detail.tsx` ã§ã¯ `team-memo-create` / `team-task-create` ã‚’ãƒªãƒƒã‚¹ãƒ³ã—ãªã„ï¼ˆMemoScreen/TaskScreen ã«ä»»ã›ã‚‹ï¼‰

---

## ğŸ“Œ 10. ã¾ã¨ã‚

### ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆã®æµã‚Œ

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒ¢/ã‚¿ã‚¹ã‚¯ã‚’é¸æŠ or æ–°è¦ä½œæˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. selectedMemoId / selectedTaskId ãŒè¨­å®šã•ã‚Œã‚‹
   ã¾ãŸã¯ isCreatingMemo / isCreatingTask ãŒ true ã«ãªã‚‹
   â†“
3. Sidebar ã® Props/Context ã«å€¤ãŒä¼æ’­
   â†“
4. sidebar.tsx:170-174 ã§ isShowingMemoEditor / isShowingTaskEditor ãŒ true ã«
   â†“
5. sidebar.tsx:177-262 ã®ä¸‰é …æ¼”ç®—å­ã§é©åˆ‡ãªãƒ•ãƒƒã‚¿ãƒ¼ã‚’è¿”ã™
   â†“
6. ãƒ¢ãƒã‚¤ãƒ«æ™‚ã®ã¿ãƒ•ãƒƒã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã€é€šå¸¸ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¯ hidden ã«ãªã‚‹
```

### æœ€é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«

1. **[sidebar.tsx](apps/web/components/layout/sidebar.tsx)** - ãƒ•ãƒƒã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆæœ¬ä½“
2. **[team-detail-context.tsx](apps/web/src/contexts/team-detail-context.tsx)** - ãƒãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹ç®¡ç†
3. **[main-client-mobile.tsx](apps/web/components/client/main-client-mobile.tsx)** - å€‹äººãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹ç”Ÿæˆ

---

**ä½œæˆæ—¥:** 2025-10-31
**å¯¾è±¡ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** Next.js 15.3.0 / React 19.0.0
